// I18N will be loaded from i18n.js as window.I18N
const qs=(s,e=document)=>e.querySelector(s), qsa=(s,e=document)=>[...e.querySelectorAll(s)];
function setLang(lang){ if(!window.I18N || !window.I18N[lang]) lang='es'; if(!window.I18N) return; localStorage.setItem('lang',lang); document.documentElement.lang=lang;
  qsa('[data-i18n]').forEach(n=>{ let v=window.I18N[lang]; for(const p of n.dataset.i18n.split('.')){ v=v?.[p]; } if(typeof v==='string') n.textContent=v; });
  const file=(location.pathname.split('/').pop()||'index.html'); const M=window.I18N[lang].meta; if(M) document.title = (file==='services.html'?M.titleServices:file==='contact.html'?M.titleContact:file==='about.html'?M.titleAbout:M.titleHome);
  const meta=qs('meta[name=description]'); if(meta && M.desc) meta.setAttribute('content', M.desc);
  qsa('nav a[data-page]').forEach(a=>a.classList.toggle('current', a.dataset.page===file));
  qsa('.lang a').forEach(a=>a.classList.toggle('active', a.dataset.lang===lang));
}
function initLang(){ setLang(localStorage.getItem('lang')||'es'); qsa('.lang a').forEach(a=>a.addEventListener('click',e=>{e.preventDefault(); setLang(a.dataset.lang)})); }
function initCookieBar(){ if(localStorage.getItem('cookieConsent')) return; const b=document.createElement('div'); b.style.cssText='position:fixed;left:0;right:0;bottom:0;padding:12px 16px;display:flex;gap:12px;align-items:center;justify-content:space-between;background:rgba(0,0,0,.85);color:#fff;z-index:9999';
  const t=document.createElement('div'); t.dataset.i18n='cookieBar.text'; const a=document.createElement('div');
  const ok=document.createElement('button'); ok.className='btn'; ok.dataset.i18n='cookieBar.accept';
  const no=document.createElement('button'); no.className='btn secondary'; no.style.color='#fff'; no.style.borderColor='#fff'; no.dataset.i18n='cookieBar.reject';
  a.append(ok,no); b.append(t,a); document.body.append(b);
  const save=v=>{localStorage.setItem('cookieConsent',v); b.remove();};
  ok.addEventListener('click',()=>save('accepted')); no.addEventListener('click',()=>save('rejected'));
  const lang=localStorage.getItem('lang')||'es'; if(window.I18N) [t,ok,no].forEach(n=>{ let v=window.I18N[lang]; for(const p of n.dataset.i18n.split('.')) v=v?.[p]; if(typeof v==='string') n.textContent=v; });
}
function initContactForm(){ const form=document.getElementById('contact-form'); if(!form) return; 
  
  // Check for success/error in URL params
  const urlParams=new URLSearchParams(window.location.search);
  if(urlParams.get('sent')==='true') showFormMessage('success');
  if(urlParams.get('error')==='true') showFormMessage('error');
  
  // Handle form submission
  form.addEventListener('submit',async e=>{
    const btn=form.querySelector('button[type="submit"]'); const originalText=btn.textContent;
    btn.disabled=true; btn.textContent='Enviando...';
    
    // Form will submit normally to Web3Forms
    // Success/error will be handled by redirect or by checking response
  }); }

function showFormMessage(type){ 
  const successEl=document.getElementById('form-success'); 
  const errorEl=document.getElementById('form-error');
  if(type==='success' && successEl) { successEl.style.display='block'; }
  if(type==='error' && errorEl) { errorEl.style.display='block'; } }
// Fallback with FULL service descriptions
if(!window.I18N) {
  window.I18N = {"es":{"meta":{"titleHome":"Dmitry Lyubimov — Servicios tecnológicos","titleServices":"Servicios — Dmitry Lyubimov","titleContact":"Contacto — Dmitry Lyubimov","titleAbout":"Sobre mí — Dmitry Lyubimov","desc":"Soluciones tecnológicas claras y mantenibles para pequeñas empresas y profesionales."},"nav":{"home":"Inicio","about":"Sobre mí","services":"Servicios","contact":"Contacto"},"hero":{"title":"Soluciones tecnológicas claras y mantenibles","subtitle":"Webs sencillas, herramientas bien configuradas y datos que ayudan a decidir.","ctaServices":"Ver servicios","ctaContact":"Contactar"},"services":{"title":"Servicios","intro":"Ayudo a pequeñas empresas y profesionales a disponer de tecnología simple, fiable y útil para el negocio.","basic":{"title":"Servicios básicos para empresas locales"},"cards":[{"title":"Creación de página web básica","text":"Sitio informativo sencillo con estructura clara, diseño adaptable a móvil y contenidos editables."},{"title":"Configuración de correo y oficina en la nube","text":"Alta y puesta a punto de cuentas, dominios y almacenamiento. Formación básica para el equipo."},{"title":"Consultoría tecnológica y datos (avanzado)","text":"Diseño de procesos de información, integración entre sistemas y automatizaciones orientadas a negocio."},{"title":"Mantenimiento técnico mensual","text":"Actualizaciones, copias de seguridad, revisión de seguridad y soporte continuo."},{"title":"Informes de gestión","text":"Tableros e informes claros (ventas, reservas, proyectos) para decidir con datos fiables."},{"title":"Plataformas de datos y procesos","text":"Organización de la información de la empresa para que sea fiable, actualizada e integrada."}],"advanced":{"title":"Servicios avanzados de consultoría y datos","intro":"Para empresas que requieren soluciones complejas de datos, infraestructura cloud y procesos automatizados a nivel empresarial.","cards":[{"title":"Consultoría y arquitectura de plataformas de datos","text":"Diseño e implementación de Data Warehouses y Data Lakes. Modelado de datos orientado a negocio (star schema, data vault). Estrategias de snapshotting, calidad de datos, gobierno de datos."},{"title":"Procesamiento de datos y automatización","text":"Creación de pipelines de datos escalables (ingesta, transformación, carga). Orquestación de procesos con Airflow/Dagster. Integración de múltiples fuentes (APIs de marketing, sistemas internos, IoT)."},{"title":"Cloud & DevOps","text":"Diseño de infraestructuras cloud seguras y optimizadas en costes. Despliegue de aplicaciones en contenedores (Docker/Kubernetes). Automatización de CI/CD y monitorización de sistemas críticos."},{"title":"Integración de datos publicitarios y analítica digital","text":"Conexión con APIs de Meta, Google, TikTok, Pinterest, etc. Consolidación de métricas de marketing y ventas en dashboards unificados. Seguimiento de KPIs (CPA, ROAS, LTV) en tiempo real."},{"title":"Optimización de costes y rendimiento","text":"Ajuste de queries y almacenamiento en plataformas analíticas (Snowflake, ClickHouse, Vertica). Políticas de retención y lifecycle management para almacenamiento eficiente. Revisión de infraestructuras para detectar riesgos y puntos de fallo."},{"title":"Consultoría técnica para equipos","text":"Definición de buenas prácticas de ingeniería de datos. Formación y mentoring para equipos internos. Soporte en procesos de auditoría y cumplimiento normativo."}]}},"contact":{"title":"Contacto","p1":"Escríbeme y responderé en 1–2 días laborables.","name":"Nombre","email":"Correo electrónico","message":"Mensaje","send":"Enviar","gdpr":"Al enviar, aceptas nuestra Política de privacidad.","alt":"O contacta directamente:","success":"¡Mensaje enviado con éxito! Te responderé en 1-2 días laborables.","error":"Error al enviar el mensaje. Intenta nuevamente o contacta directamente."},"footer":{"copyright":"© 2025 Dmitry Lyubimov — Barcelona","privacy":"Política de privacidad","legal":"Aviso legal","cookies":"Política de cookies","linkedin":"LinkedIn"},"cookieBar":{"text":"Este sitio utiliza solo cookies técnicas para recordar tu idioma. Puedes aceptar o rechazar.","accept":"Aceptar","reject":"Rechazar"}},"en":{"meta":{"titleHome":"Dmitry Lyubimov — Technology Services","titleServices":"Services — Dmitry Lyubimov","titleContact":"Contact — Dmitry Lyubimov","titleAbout":"About me — Dmitry Lyubimov","desc":"Clear, maintainable tech solutions for small businesses and professionals."},"nav":{"home":"Home","about":"About me","services":"Services","contact":"Contact"},"hero":{"title":"Clear, maintainable technology solutions","subtitle":"Simple websites, well‑configured tools, and data that supports decisions.","ctaServices":"View services","ctaContact":"Get in touch"},"services":{"title":"Services","intro":"I help small businesses and professionals with simple, reliable, business‑friendly technology.","basic":{"title":"Basic services for local businesses"},"cards":[{"title":"Basic website creation","text":"Simple informational site with clear structure, mobile‑friendly design, and editable content."},{"title":"Email & cloud office setup","text":"Set up accounts, domains, and storage. Basic training for the team."},{"title":"Advanced tech & data consulting","text":"Design of information processes, system integrations, and business‑oriented automations."},{"title":"Monthly technical maintenance","text":"Updates, backups, security reviews, and ongoing support."},{"title":"Management reporting","text":"Clear dashboards and reports (sales, bookings, projects) for data‑driven decisions."},{"title":"Data platforms & processes","text":"Organising company information so it's reliable, current, and integrated."}],"advanced":{"title":"Advanced consulting & data services","intro":"For enterprises requiring complex data solutions, cloud infrastructure, and enterprise-level automated processes.","cards":[{"title":"Data platform consulting & architecture","text":"Design and implementation of Data Warehouses and Data Lakes. Business-oriented data modeling (star schema, data vault). Snapshotting strategies, data quality, data governance."},{"title":"Data processing & automation","text":"Creating scalable data pipelines (ingestion, transformation, loading). Process orchestration with Airflow/Dagster. Multi-source integration (marketing APIs, internal systems, IoT)."},{"title":"Cloud & DevOps","text":"Design of secure and cost-optimized cloud infrastructures. Container deployment (Docker/Kubernetes). CI/CD automation and critical system monitoring."},{"title":"Advertising data integration & digital analytics","text":"Integration with Meta, Google, TikTok, Pinterest APIs, etc. Consolidation of marketing and sales metrics in unified dashboards. Real-time KPI tracking (CPA, ROAS, LTV)."},{"title":"Cost & performance optimization","text":"Query and storage optimization in analytics platforms (Snowflake, ClickHouse, Vertica). Retention policies and lifecycle management for efficient storage. Infrastructure reviews to detect risks and failure points."},{"title":"Technical consulting for teams","text":"Definition of data engineering best practices. Training and mentoring for internal teams. Support in audit processes and regulatory compliance."}]}},"contact":{"title":"Contact","p1":"Send a message and I'll reply within 1–2 business days.","name":"Name","email":"Email","message":"Message","send":"Send","gdpr":"By sending, you accept our Privacy Policy.","alt":"Or contact directly:","success":"Message sent successfully! I'll reply within 1-2 business days.","error":"Error sending message. Please try again or contact directly."},"footer":{"copyright":"© 2025 Dmitry Lyubimov — Barcelona","privacy":"Privacy Policy","legal":"Legal Notice","cookies":"Cookie Policy","linkedin":"LinkedIn"},"cookieBar":{"text":"This site only uses technical cookies to remember your language. You can accept or reject.","accept":"Accept","reject":"Reject"}},"ca":{"meta":{"titleHome":"Dmitry Lyubimov — Serveis tecnològics","titleServices":"Serveis — Dmitry Lyubimov","titleContact":"Contacte — Dmitry Lyubimov","titleAbout":"Sobre mi — Dmitry Lyubimov","desc":"Solucions tecnològiques clares i mantenibles per a petites empreses i professionals."},"nav":{"home":"Inici","about":"Sobre mi","services":"Serveis","contact":"Contacte"},"hero":{"title":"Solucions tecnològiques clares i mantenibles","subtitle":"Webs senzilles, eines ben configurades i dades que ajuden a decidir.","ctaServices":"Veure serveis","ctaContact":"Contactar"},"services":{"title":"Serveis","intro":"Ajudo petites empreses i professionals amb tecnologia simple, fiable i útil per al negoci.","basic":{"title":"Serveis bàsics per a empreses locals"},"cards":[{"title":"Creació de pàgina web bàsica","text":"Lloc informatiu senzill amb estructura clara, disseny adaptable i continguts editables."},{"title":"Configuració de correu i oficina al núvol","text":"Alta i posada a punt de comptes, dominis i emmagatzematge. Formació bàsica per a l'equip."},{"title":"Consultoria tecnològica i dades (avançat)","text":"Disseny de processos d'informació, integració entre sistemes i automatitzacions orientades al negoci."},{"title":"Manteniment tècnic mensual","text":"Actualitzacions, còpies de seguretat, revisió de seguretat i suport continu."},{"title":"Informes de gestió","text":"Panells i informes clars (vendes, reserves, projectes) per prendre decisions amb dades fiables."},{"title":"Plataformes de dades i processos","text":"Organització de la informació de l'empresa perquè sigui fiable, actualitzada i integrada."}],"advanced":{"title":"Serveis avançats de consultoria i dades","intro":"Per a empreses que requereixen solucions complexes de dades, infraestructura cloud i processos automatitzats a nivell empresarial.","cards":[{"title":"Consultoria i arquitectura de plataformes de dades","text":"Disseny i implementació de Data Warehouses i Data Lakes. Modelatge de dades orientat a negoci (star schema, data vault). Estratègies de snapshotting, qualitat de dades, govern de dades."},{"title":"Processament de dades i automatització","text":"Creació de pipelines de dades escalables (ingesta, transformació, càrrega). Orquestració de processos amb Airflow/Dagster. Integració de múltiples fonts (APIs de màrqueting, sistemes interns, IoT)."},{"title":"Cloud & DevOps","text":"Disseny d'infraestructures cloud segures i optimitzades en costos. Desplegament d'aplicacions en contenidors (Docker/Kubernetes). Automatització de CI/CD i monitoratge de sistemes crítics."},{"title":"Integració de dades publicitàries i analítica digital","text":"Connexió amb APIs de Meta, Google, TikTok, Pinterest, etc. Consolidació de mètriques de màrqueting i vendes en dashboards unificats. Seguiment de KPIs (CPA, ROAS, LTV) en temps real."},{"title":"Optimització de costos i rendiment","text":"Ajust de consultes i emmagatzematge en plataformes analítiques (Snowflake, ClickHouse, Vertica). Polítiques de retenció i lifecycle management per a emmagatzematge eficient. Revisió d'infraestructures per detectar riscos i punts de fallada."},{"title":"Consultoria tècnica per a equips","text":"Definició de bones pràctiques d'enginyeria de dades. Formació i mentoring per a equips interns. Suport en processos d'auditoria i compliment normatiu."}]}},"contact":{"title":"Contacte","p1":"Escriu-me i respondré en 1–2 dies laborables.","name":"Nom","email":"Correu electrònic","message":"Missatge","send":"Enviar","gdpr":"En enviar, acceptes la nostra Política de privacitat.","alt":"O contacta directament:","success":"Missatge enviat amb èxit! Respondré en 1-2 dies laborables.","error":"Error en enviar el missatge. Torna a provar o contacta directament."},"footer":{"copyright":"© 2025 Dmitry Lyubimov — Barcelona","privacy":"Política de privacitat","legal":"Avís legal","cookies":"Política de cookies","linkedin":"LinkedIn"},"cookieBar":{"text":"Aquest lloc utilitza només cookies tècniques per recordar l'idioma. Pots acceptar o rebutjar.","accept":"Acceptar","reject":"Rebutjar"}}};
}

document.addEventListener('DOMContentLoaded', ()=>{ initLang(); initCookieBar(); initContactForm(); });
